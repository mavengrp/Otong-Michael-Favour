<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lawyer Portfolio | Functional</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; scroll-behavior: smooth; }
        h1, h2, .serif { font-family: 'Playfair Display', serif; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">

    <nav class="flex justify-between items-center px-10 py-6 bg-white border-b border-slate-200 sticky top-0 z-50">
        <div id="site-logo" class="text-2xl font-bold tracking-tighter uppercase serif"></div>
        <div class="space-x-8 font-medium text-sm uppercase tracking-widest">
            <a href="#about" class="hover:text-[#4A0404] transition">About</a>
            <a href="#articles" class="hover:text-[#4A0404] transition">Insights</a>
            <a href="michealfavourotong@email.com" class="bg-[#4A0404] text-white px-6 py-3 rounded-sm hover:bg-[#3A0303] transition">Contact</a>
            <button id="login-btn" class="hover:text-[#4A0404] transition">Login</button>
            <button id="edit-profile-btn" class="hover:text-[#4A0404] transition hidden">Edit Profile</button>
        </div>
    </nav>

    <!-- Login Modal -->
    <div id="login-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded shadow-lg max-w-sm w-full">
            <h3 class="text-xl mb-4">Admin Login</h3>
            <input id="password" type="password" placeholder="Password" class="w-full p-2 border mb-4">
            <button id="submit-login" class="bg-[#4A0404] text-white px-4 py-2 rounded">Login</button>
            <button id="close-login" class="ml-2 px-4 py-2 border">Cancel</button>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div id="edit-profile-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded shadow-lg max-w-md w-full max-h-[90vh] overflow-y-auto">
            <h3 class="text-xl mb-4">Edit Profile</h3>
            <input id="edit-hero-title" type="text" placeholder="Hero Title" class="w-full p-2 border mb-4">
            <input id="edit-hero-subtitle" type="text" placeholder="Hero Subtitle" class="w-full p-2 border mb-4">
            <textarea id="edit-bio" placeholder="Bio (separate paragraphs by new lines)" class="w-full p-2 border mb-4" rows="10"></textarea>
            <button id="submit-edit-profile" class="bg-[#4A0404] text-white px-4 py-2 rounded">Update Profile</button>
            <button id="close-edit-profile" class="ml-2 px-4 py-2 border">Cancel</button>
        </div>
    </div>

    <!-- Add Article Modal -->
    <div id="add-article-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded shadow-lg max-w-md w-full max-h-[90vh] overflow-y-auto">
            <h3 class="text-xl mb-4">Add New Article</h3>
            <input id="article-title" type="text" placeholder="Title" class="w-full p-2 border mb-4">
            <input id="article-category" type="text" placeholder="Category" class="w-full p-2 border mb-4">
            <textarea id="article-summary" placeholder="Summary" class="w-full p-2 border mb-4" rows="3"></textarea>
            <input id="article-image" type="file" accept="image/*" class="w-full p-2 border mb-4">
            <textarea id="article-content" placeholder="Full Content" class="w-full p-2 border mb-4" rows="10"></textarea>
            <input id="article-url" type="url" placeholder="Article URL (optional, e.g., LinkedIn post)" class="w-full p-2 border mb-4">
            <button id="submit-article" class="bg-[#4A0404] text-white px-4 py-2 rounded">Add Article</button>
            <button id="close-article" class="ml-2 px-4 py-2 border">Cancel</button>
        </div>
    </div>

    <!-- Edit Article Modal -->
    <div id="edit-article-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded shadow-lg max-w-md w-full max-h-[90vh] overflow-y-auto">
            <h3 class="text-xl mb-4">Edit Article</h3>
            <input id="edit-article-title" type="text" placeholder="Title" class="w-full p-2 border mb-4">
            <input id="edit-article-category" type="text" placeholder="Category" class="w-full p-2 border mb-4">
            <textarea id="edit-article-summary" placeholder="Summary" class="w-full p-2 border mb-4" rows="3"></textarea>
            <input id="edit-article-image" type="file" accept="image/*" class="w-full p-2 border mb-4">
            <textarea id="edit-article-content" placeholder="Full Content" class="w-full p-2 border mb-4" rows="10"></textarea>
            <input id="edit-article-url" type="url" placeholder="Article URL (optional, e.g., LinkedIn post)" class="w-full p-2 border mb-4">
            <button id="submit-edit-article" class="bg-[#4A0404] text-white px-4 py-2 rounded">Update Article</button>
            <button id="close-edit-article" class="ml-2 px-4 py-2 border">Cancel</button>
        </div>
    </div>

    <!-- View Full Article Modal -->
    <div id="view-article-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded shadow-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <h3 id="view-article-title" class="text-2xl mb-4"></h3>
            <p id="view-article-summary" class="text-slate-600 mb-4"></p>
            <div id="view-article-content" class="text-lg leading-relaxed"></div>
            <button id="close-view-article" class="mt-4 bg-[#4A0404] text-white px-4 py-2 rounded">Close</button>
        </div>
    </div>

    <header class="relative bg-[#4A0404] min-h-[500px] flex items-center">
        <div class="container mx-auto px-10 grid md:grid-cols-2 gap-10 items-center">
            <div class="text-white py-20">
                <h1 id="hero-title" class="text-6xl leading-tight mb-6"></h1>
                <p id="hero-subtitle" class="text-lg text-slate-300 max-w-md mb-8"></p>
                <a href="#articles" class="border-2 border-white px-8 py-3 text-sm uppercase tracking-widest hover:bg-white hover:text-[#4A0404] transition">Read My Articles</a>
            </div>
            <div id="hero-image" class="hidden md:block h-[500px] bg-cover bg-center rounded shadow-2xl"></div>
        </div>
    </header>

    <section id="about" class="bg-white py-20">
        <div class="container mx-auto px-10 max-w-4xl">
            <h2 class="text-4xl mb-8 border-b pb-4">About Me</h2>
            <div id="about-content" class="text-lg text-slate-700 leading-relaxed space-y-4">
                </div>
        </div>
    </section>

    <section id="articles" class="container mx-auto px-10 py-20">
        <div class="flex justify-between items-center mb-12">
            <h2 class="text-4xl">Legal Insights & Publications</h2>
            <button id="add-article-btn" class="bg-[#4A0404] text-white px-4 py-2 rounded hidden">Add Article</button>
        </div>
        <div id="article-grid" class="grid md:grid-cols-3 gap-10">
            </div>
    </section>

    <footer class="bg-[#4A0404] text-white py-10 text-center">
        <p id="footer-cr" class="text-slate-500 text-xs tracking-widest uppercase"></p>
    </footer>

    <script>
        // Default profile data
        const defaultProfile = {
            name: "Otong Micheal Favor",
            firmName: "OTONG & Associates",
            heroTitle: "Strategy Focused on <br><span class='italic text-slate-400'>Results.</span>",
            heroSubtitle: "Dedicated to providing clarity in complex legal environments.",
            profileImage: "./profile photo.jpg",
            bio: [
                "I am highly organized, adaptable and result driven professional with a strong ability to multitask and perform effectively in a fast paced, deadline driven environment.",
                "My academic training and practical experience have shaped me into solution oriented and inquisitive individual with strong critical thinking and problem solving skills.",
                "I possess excellent communication, interpersonal, counseling, and advanced computer skills, which I apply with professionalism and precision.",
                "I am deeply commited to contributing meaningfully to organisations that value reserch, policy development, public education, good governance and access to justice."
            ]
        };

        // Load profile from localStorage or use defaults
        let lawyerProfile = JSON.parse(localStorage.getItem('lawyerProfile')) || defaultProfile;

        // Load articles from localStorage or start with empty array
        let articles = JSON.parse(localStorage.getItem('articles')) || [];

        let isLoggedIn = false;
        let editIndex = -1;

        // --- 2. ENGINE: THIS INJECTS THE DATA INTO THE HTML ---
        function renderProfile() {
            document.getElementById('site-logo').innerHTML = `${lawyerProfile.name} <span class="text-[#4A0404]">&</span> Co.`;
            document.getElementById('hero-title').innerHTML = lawyerProfile.heroTitle;
            document.getElementById('hero-subtitle').innerText = lawyerProfile.heroSubtitle;
            document.getElementById('hero-image').style.backgroundImage = `url('${lawyerProfile.profileImage}')`;
            document.getElementById('footer-cr').innerText = `Â© 2026 ${lawyerProfile.firmName}. All Rights Reserved.`;

            // Inject Bio
            const bioContainer = document.getElementById('about-content');
            bioContainer.innerHTML = '';
            lawyerProfile.bio.forEach(para => {
                const p = document.createElement('p');
                p.innerText = para;
                bioContainer.appendChild(p);
            });
        }

        renderProfile();

        // Inject Articles
        function renderArticles() {
            const grid = document.getElementById('article-grid');
            grid.innerHTML = '';
            articles.forEach((post, index) => {
                const adminButtons = isLoggedIn ? `
                    <div class="flex space-x-2 mt-4">
                        <button class="edit-btn bg-[#D4AF37] text-white px-3 py-1 rounded text-xs" data-index="${index}">Edit</button>
                        <button class="delete-btn bg-[#8B0000] text-white px-3 py-1 rounded text-xs" data-index="${index}">Delete</button>
                    </div>
                ` : '';
                grid.innerHTML += `
                    <article class="bg-white border border-slate-200 group cursor-pointer hover:shadow-lg transition-all overflow-hidden" data-index="${index}">
                        <div class="h-48 overflow-hidden">
                            <img src="${post.image}" class="w-full h-full object-cover group-hover:scale-105 transition duration-500">
                        </div>
                        <div class="p-6">
                            <span class="text-xs font-bold text-[#4A0404] uppercase tracking-widest">${post.category}</span>
                            <h3 class="text-xl mt-2 mb-3 font-semibold group-hover:text-[#4A0404]">${post.title}</h3>
                            <p class="text-slate-600 text-sm mb-4">${post.summary}</p>
                            <div class="text-xs text-slate-400 font-medium uppercase">${post.date}</div>
                            ${adminButtons}
                        </div>
                    </article>
                `;
            });
            // Attach event listeners after rendering
            attachArticleEvents();
        }

        function attachArticleEvents() {
            document.querySelectorAll('#article-grid article').forEach(article => {
                article.addEventListener('click', (e) => {
                    if (e.target.classList.contains('edit-btn') || e.target.classList.contains('delete-btn')) return;
                    const index = parseInt(article.dataset.index);
                    const post = articles[index];
                    if (post.url) {
                        window.open(post.url, '_blank');
                    } else {
                        document.getElementById('view-article-title').innerText = post.title;
                        document.getElementById('view-article-summary').innerText = post.summary;
                        document.getElementById('view-article-content').innerText = post.content;
                        document.getElementById('view-article-modal').classList.remove('hidden');
                    }
                });
            });
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    const index = parseInt(e.target.dataset.index);
                    if (confirm('Are you sure you want to delete this article?')) {
                        articles.splice(index, 1);
                        localStorage.setItem('articles', JSON.stringify(articles));
                        renderArticles();
                    }
                });
            });
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    editIndex = parseInt(e.target.dataset.index);
                    const post = articles[editIndex];
                    document.getElementById('edit-article-title').value = post.title;
                    document.getElementById('edit-article-category').value = post.category;
                    document.getElementById('edit-article-summary').value = post.summary;
                    // Note: File input can't be pre-filled, so image remains as is unless changed
                    document.getElementById('edit-article-content').value = post.content;
                    document.getElementById('edit-article-url').value = post.url;
                    document.getElementById('edit-article-modal').classList.remove('hidden');
                });
            });
        }

        renderArticles();

        // Login functionality
        document.getElementById('login-btn').addEventListener('click', () => {
            if (isLoggedIn) {
                isLoggedIn = false;
                document.getElementById('login-btn').textContent = 'Login';
                document.getElementById('edit-profile-btn').classList.add('hidden');
                document.getElementById('add-article-btn').classList.add('hidden');
                renderArticles(); // Re-render to hide buttons
            } else {
                document.getElementById('login-modal').classList.remove('hidden');
            }
        });

        document.getElementById('close-login').addEventListener('click', () => {
            document.getElementById('login-modal').classList.add('hidden');
        });

        document.getElementById('submit-login').addEventListener('click', () => {
            const password = document.getElementById('password').value;
            if (password === 'admin') {  // Simple password check
                isLoggedIn = true;
                document.getElementById('login-modal').classList.add('hidden');
                document.getElementById('login-btn').textContent = 'Logout';
                document.getElementById('edit-profile-btn').classList.remove('hidden');
                document.getElementById('add-article-btn').classList.remove('hidden');
                renderArticles(); // Re-render to show buttons
            } else {
                alert('Incorrect password');
            }
        });

        // Edit Profile functionality
        document.getElementById('edit-profile-btn').addEventListener('click', () => {
            document.getElementById('edit-hero-title').value = lawyerProfile.heroTitle.replace(/<br>/g, '\n').replace(/<[^>]*>/g, ''); // Simple strip for editing
            document.getElementById('edit-hero-subtitle').value = lawyerProfile.heroSubtitle;
            document.getElementById('edit-bio').value = lawyerProfile.bio.join('\n');
            document.getElementById('edit-profile-modal').classList.remove('hidden');
        });

        document.getElementById('close-edit-profile').addEventListener('click', () => {
            document.getElementById('edit-profile-modal').classList.add('hidden');
        });

        document.getElementById('submit-edit-profile').addEventListener('click', () => {
            const heroTitle = document.getElementById('edit-hero-title').value.replace(/\n/g, '<br>');
            const heroSubtitle = document.getElementById('edit-hero-subtitle').value;
            const bioText = document.getElementById('edit-bio').value;
            const bio = bioText.split('\n').filter(line => line.trim() !== '');
            lawyerProfile.heroTitle = heroTitle;
            lawyerProfile.heroSubtitle = heroSubtitle;
            lawyerProfile.bio = bio;
            localStorage.setItem('lawyerProfile', JSON.stringify(lawyerProfile));
            renderProfile();
            document.getElementById('edit-profile-modal').classList.add('hidden');
        });

        // Helper function to read file as base64
        function readFileAsBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        // Add Article functionality
        document.getElementById('add-article-btn').addEventListener('click', () => {
            document.getElementById('add-article-modal').classList.remove('hidden');
        });

        document.getElementById('close-article').addEventListener('click', () => {
            document.getElementById('add-article-modal').classList.add('hidden');
        });

        document.getElementById('submit-article').addEventListener('click', async () => {
            const title = document.getElementById('article-title').value;
            const category = document.getElementById('article-category').value;
            const summary = document.getElementById('article-summary').value;
            const imageFile = document.getElementById('article-image').files[0];
            const content = document.getElementById('article-content').value;
            const url = document.getElementById('article-url').value;
            if (title && category && summary && imageFile && content) {
                try {
                    const image = await readFileAsBase64(imageFile);
                    const newArticle = {
                        title,
                        category,
                        summary,
                        image,
                        content,
                        date: new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' }),
                        url
                    };
                    articles.unshift(newArticle);
                    localStorage.setItem('articles', JSON.stringify(articles));
                    renderArticles();
                    document.getElementById('add-article-modal').classList.add('hidden');
                    // Clear form
                    document.getElementById('article-title').value = '';
                    document.getElementById('article-category').value = '';
                    document.getElementById('article-summary').value = '';
                    document.getElementById('article-image').value = '';
                    document.getElementById('article-content').value = '';
                    document.getElementById('article-url').value = '';
                } catch (error) {
                    alert('Error reading image file');
                }
            } else {
                alert('Please fill all fields and select an image');
            }
        });

        // Edit Article functionality
        document.getElementById('close-edit-article').addEventListener('click', () => {
            document.getElementById('edit-article-modal').classList.add('hidden');
        });

        document.getElementById('submit-edit-article').addEventListener('click', async () => {
            const title = document.getElementById('edit-article-title').value;
            const category = document.getElementById('edit-article-category').value;
            const summary = document.getElementById('edit-article-summary').value;
            const imageFile = document.getElementById('edit-article-image').files[0];
            const content = document.getElementById('edit-article-content').value;
            const url = document.getElementById('edit-article-url').value;
            if (title && category && summary && content && editIndex >= 0) {
                try {
                    let image = articles[editIndex].image; // Keep existing if no new file
                    if (imageFile) {
                        image = await readFileAsBase64(imageFile);
                    }
                    articles[editIndex] = {
                        title,
                        category,
                        summary,
                        image,
                        content,
                        date: articles[editIndex].date, // Keep original date
                        url
                    };
                    localStorage.setItem('articles', JSON.stringify(articles));
                    renderArticles();
                    document.getElementById('edit-article-modal').classList.add('hidden');
                    editIndex = -1;
                } catch (error) {
                    alert('Error reading image file');
                }
            } else {
                alert('Please fill all fields');
            }
        });

        // View Article functionality
        document.getElementById('close-view-article').addEventListener('click', () => {
            document.getElementById('view-article-modal').classList.add('hidden');
        });
    </script>
</body>
</html>